geno <- read.table("data/E-GEOD-51403-raw-counts") # SNPs matrix of samples from nine different dog breeds
read.tsv("data/E-GEOD-51403-raw-counts.tsv")
read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
geno <- read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
geno <- read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
geno
geno <- read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
print(geno)
geno <- read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
read.table(file = "data/E-GEOD-51403-raw-counts.tsv", sep = '\t', header = TRUE)
read.csv("data/E-GEOD-51403-raw-counts.tsv")
geno <- read.csv("data/E-GEOD-51403-raw-counts.tsv")
geno <- read.csv("data/E-GEOD-51403-raw-counts.tsv")
geno
geno <- read.csv("data/E-GEOD-51403-raw-counts.tsv",sep = "\t")
geno
geno <- read.csv("data/E2_treatment",sep = "\t")
geno <- read.csv("data/E2_treatment",sep = "\t")
geno <- read.csv("data/E2_treatment.tsv",sep = "\t")
geno
E2 <- read.csv("data/E2_treatment.tsv",sep = "\t")
ZNA <- read.csv("data/ZNA_molocule_treatment",sep = "\t")
E2 <- read.csv("data/E2_treatment.tsv",sep = "\t")
ZNA <- read.csv("data/ZNA_molocule_treatment.tsv",sep = "\t")
head(E2)
head(ZNA)
E2 <- read.csv("data/E2_treatment.tsv",sep = "\t")
ZNA <- read.csv("data/ZNA_molocule_treatment.tsv",sep = "\t")
E2
ZNA
E2 <- read.csv("data/GSE51403_count.matrix.byGene.round1.txt",sep = "\t")
ZNA <- read.csv("data/ZNA_molocule_treatment.tsv",sep = "\t")
E2
ZNA
E2 <- read.csv("data/E2_treatment.tsv",sep = "\t")
ZNA <- read.csv("data/ZNA_molocule_treatment.tsv",sep = "\t")
E2
ZNA
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
library(plyr)
library(DESeq2)
library(ashr)
library(EnhancedVolcano)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library(EnhancedVolcano)
packages_for_tutorial <- c("DESeq2", "ggplot2", "GEOquery", "hrbrthemes", "viridis", "AnnotationDbi", "org.Hs.eg.db",
"ReportingTools", "EnhancedVolcano", "pheatmap", "vsn", "AnnotationHub","EnsDb.Hsapiens.v86")
not_installed <- packages_for_tutorial[!(packages_for_tutorial %in% installed.packages()[ , "Package"])]
for (package in not_installed) {
BiocManager::install(package) #
}
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library(org.Mm.eg.db)
packages_for_tutorial <- c("org.Hs.eg.db")
not_installed <- packages_for_tutorial[!(packages_for_tutorial %in% installed.packages()[ , "Package"])]
for (package in not_installed) {
BiocManager::install(package) #
}
packages_for_tutorial <- c("org.Hs.eg.db")
not_installed <- packages_for_tutorial[!(packages_for_tutorial %in% installed.packages()[ , "Package"])]
for (package in not_installed) {
BiocManager::install(package) #
}
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library(org.Mm.eg.db)
packages_for_tutorial <- c("org.Mm.eg.db")
not_installed <- packages_for_tutorial[!(packages_for_tutorial %in% installed.packages()[ , "Package"])]
for (package in not_installed) {
BiocManager::install(package) #
}
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library(org.Mm.eg.db)
library(ggplot2)
#dataset 1 - E2 sampels
counts1 <- read.table("data/E2_treatment.tsv", sep='\t', header=T)
genes.symbols1 <- counts1[,2]
counts1 <- counts1[,-2]
metadata1 <- read.table("data/E2coldata.tsv", sep='\t', header=T)
counts1[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 1
newdata <- metadata1[8]
rownames(newdata) <- metadata1[,1]
metadata1 <- newdata
names(metadata1)[1] <- "compound"
metadata1[1] <- mapvalues(metadata1[,1],c("17beta-estradiol 10 nanomolar","vehicle") , c("E2","DMSO"))
metadata1$compound <- as.factor(metadata1$compound)
# Ordering the values
metadata1 <- metadata1[order(match(rownames(metadata1),colnames(counts1)[-1])), , drop= FALSE]
##Metadata 1
newdata <- metadata1[8]
#dataset 1 - E2 sampels
counts1 <- read.table("data/E2_treatment.tsv", sep='\t', header=T)
genes.symbols1 <- counts1[,2]
counts1 <- counts1[,-2]
metadata1 <- read.table("data/E2coldata.tsv", sep='\t', header=T)
counts1[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 1
newdata <- metadata1[8]
rownames(newdata) <- metadata1[,1]
metadata1 <- newdata
names(metadata1)[1] <- "compound"
metadata1[1] <- mapvalues(metadata1[,1],c("17beta-estradiol 10 nanomolar","vehicle") , c("E2","DMSO"))
metadata1$compound <- as.factor(metadata1$compound)
# Ordering the values
metadata1 <- metadata1[order(match(rownames(metadata1),colnames(counts1)[-1])), , drop= FALSE]
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
dds1 <- DESeqDataSetFromMatrix(countData=counts1, colData=metadata1, design= ~compound,tidy=TRUE)
dds1 <- DESeq(dds1)
resultsNames(dds1)
resLFC1 <- lfcShrink(dds1, contrast = c("compound", "E2", "DMSO") , type="ashr")
plotMA(resLFC1)
resLFC1$symbol <- genes.symbols1
resOrdered1 <- resLFC1[order(resLFC1$pvalue),]
dds2 <- DESeqDataSetFromMatrix(countData=counts2 , colData=metadata2, design= ~compound,tidy=TRUE)
dds2 <- DESeq(dds2)
resultsNames(dds2)
resLFC2 <- lfcShrink(dds2, contrast = c("compound", "ZNA", "DMSO") , type="ashr")
plotMA(resLFC2)
resLFC2$symbol <- genes.symbols2
resOrdered2 <- resLFC2[order(resLFC2$pvalue),]
# Dataset1
EnhancedVolcano(resOrdered1,
lab = resOrdered1$symbol,
x = 'log2FoldChange',
y = 'padj',
labSize=3,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
# Dataset2
EnhancedVolcano(resOrdered2,
lab = resOrdered2$symbol,
x = 'log2FoldChange',
y = 'padj',
labSize=3,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1.1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library("org.Hs.eg.db")
library(ggplot2)
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1.1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
pheatmap(normcounts[select,], cluster_rows=TRUE,
show_colnames = FALSE,cluster_cols=TRUE,
annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
pheatmap(normcounts[select,], cluster_rows=TRUE,
show_colnames = FALSE,cluster_cols=TRUE,
annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library("org.Hs.eg.db")
library(ggplot2)
library(pheatmap)
library(pheatmap)
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library("org.Hs.eg.db")
library(ggplot2)
library(pheatmap)
library(DESeq2)
library(plyr)
library(EnhancedVolcano)
library("org.Hs.eg.db")
library(ggplot2)
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
pheatmap(normcounts[select,], cluster_rows=TRUE,
show_colnames = FALSE,cluster_cols=TRUE,
annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup=c('disease','severity'))
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
#Running PCA between ZNA and DMSO
dds.symbol <- dds2
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds2),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds2)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
merged_counts <- na.omit(merged_counts)
#leaving only the columns that are related to DMSO of metadata1&metadata2&metadata3
DMSO_counts1 <- counts1[ c(1,6,7,8,9)]
DMSO_counts2 <- counts2[ c(4,5,7,9,10,11)]
View(DMSO_counts1)
View(DMSO_counts2)
merged_DMSO <- merge(x= DMSO_counts1,y=DMSO_counts2,by="Gene.ID" ,all.x=TRUE)
merged_counts <- na.omit(merged_counts)
#leaving only the columns that are related to DMSO of metadata1&metadata2&metadata3
DMSO_counts1 <- counts1[ c(1,6,7,8,9)]
DMSO_counts2 <- counts2[ c(4,5,7,9,10,11)]
View(DMSO_counts1)
View(DMSO_counts2)
merged_DMSO <- merge(x= DMSO_counts1,y=DMSO_counts2,by="Gene.ID" ,all.x=TRUE)
