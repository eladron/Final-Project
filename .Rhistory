rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
hrs3 <- c(2,6,9,11,12,13)
counts3 <- counts2[-hrs12]
counts2 <- counts2[hrs12]
hrs3 <- c(1,5,8,10,11,12)
metadata3 <- metadata3(hrs3,)
metadata3 <- metadata2(hrs3,)
metadata2
metadata3 <- metadata2[hrs3,]
metadata3
metadata2 <- metadata2[-hrs3,]
metadata2
counts2
rownames(counts2)==metadata2
colnames(counts2)==metadata2
colnames(counts2)
rownames(metadata2)
metadata2
#dataset 1 - E2 sampels
counts1 <- read.table("data/E2_treatment.tsv", sep='\t', header=T)
genes.symbols1 <- counts1[,2]
counts1 <- counts1[,-2]
metadata1 <- read.table("data/E2coldata.tsv", sep='\t', header=T)
counts1[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 1
newdata <- metadata1[8]
rownames(newdata) <- metadata1[,1]
metadata1 <- newdata
names(metadata1)[1] <- "compound"
metadata1[1] <- mapvalues(metadata1[,1],c("17beta-estradiol 10 nanomolar","vehicle") , c("E2","DMSO"))
metadata1$compound <- as.factor(metadata1$compound)
# Ordering the values
metadata1 <- metadata1[order(match(rownames(metadata1),colnames(counts1)[-1])), , drop= FALSE]
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
hrs3 <- c(2,6,9,11,12,13)
counts3 <- counts2[-hrs12]
counts2 <- counts2[hrs12]
counts2
metadata2
metadata2[0]
metadata2[1]
metadata2[1,]
hrs3 <- c(1,5,8,10,11,12)
metadata3 <- metadata2[hrs3,]
metadata2 <- metadata2[-hrs3,]
metadata2
##Metadata 1
newdata <- metadata1[8]
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
hrs3 <- c(2,6,9,11,12,13)
counts3 <- counts2[-hrs12]
counts2 <- counts2[hrs12]
counts3
counts2
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
counts2 <- counts2[c(1,2,6,9,11,12,13)]
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
counts2
counts2 <- counts2[c(1,2,6,9,11,12,13)]
counts2
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
counts2 <- counts2[c(1,2,6,9,11,12,13)]
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2)[-1])), , drop= FALSE]
counts3 <- counts2[c(1,3,4,5,7,8,10)]
counts3[apply(counts3[,-1], 1, function(x) !all(x==0)),] # remove zeros
counts2 <- counts2[c(1,2,6,9,11,12,13)]
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
View(metadata2)
metadata2[2,]
a <- metadata2[2,]
a
View(a)
a <- metadata2[c(2),]
a
View(a)
a< - metadata2[c(2,3),]
a <- metadata2[c(2,3),]
a
View(a)
metadata[2,]
metadata2[2,]
type(metadata2)
metadata2.rownames
metadata2.rownames()
metadata2.names
rownames(metadata2)
a <- metadata2[c(1,5,8,10,11,12),]
a
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
\rownames(metadata2)[c(1,5,8,10,11,12)]
rownames(metadata2)[c(1,5,8,10,11,12)]
b <- rownames(metadata2)[c(1,5,8,10,11,12)]
b
rownames(a) <- b
rownames(a)
a
View(a)
hrs3 <- c(1,5,8,10,11,12)
metadata3 <- metadata2[hrs3,]
metadata3
View(metadata3)
metadata2
metadata2["compund"]
metadata2["compound"]
metadata2["compound"]
metadata2[1,"compound"]
a <- data,frame(metadata2[1,"compound"])
a <- data.frame(metadata2[1,"compound"])
a
View(A)
View(a)
a <- data.frame(metadata2[c(1,5,8,10,11,12,13),])
a
View*a()
View(a)
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
a
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
a
names(a)
names(a)[1] <- "compound"
names(a)
a
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)
rownames(a)
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
names(a)[1] <- "compound"
a
metadata3 <- data.frame(metadata2[c(2,3,4,6,7,9),])
rownames(metadata3) <- rownames(metadata2)[c(2,3,4,6,7,9)]
names(metadata3)[1] <- "compound"
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
names(a)[1] <- "compound"
#metadata2 <- a
metadata3
counts3
names(counts3) == rownames(metadata3)
names(counts3)
names(counts3)[2,] == rownames(metadata3)
names(counts3)[2,]
names(counts3)[1,]
names(counts3)[2]
names(counts3)[2,3,4,5,6,7]
names(counts3)
names(counts3)[2] == roanames(metadata3)[1]
names(counts3)[2] == rownames(metadata3)[1]
names(counts3)[3] == rownames(metadata3)[2]
names(counts3)[4] == rownames(metadata3)[3]
names(counts3)[5] == rownames(metadata3)[4]
names(counts3)[6] == rownames(metadata3)[5]
names(counts3)[7] == rownames(metadata3)[6]
names(counts3)[8] == rownames(metadata3)[7]
names(counts3)[7] == rownames(metadata3)[6]
metadata3 <- data.frame(metadata2[c(2,3,4,6,7,9),])
rownames(metadata3) <- rownames(metadata2)[c(2,3,4,6,7,9)]
names(metadata3)[1] <- "compound"
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
names(a)[1] <- "compound"
metadata2 <- a
counts1
View(counts1)
metadata3
metadata2
dds1 <- DESeqDataSetFromMatrix(countData=counts1, colData=metadata1, design= ~compound,tidy=TRUE)
dds1 <- DESeq(dds1)
resultsNames(dds1)
resLFC1 <- lfcShrink(dds1, contrast = c("compound", "E2", "DMSO") , type="ashr")
plotMA(resLFC1)
resLFC1$symbol <- genes.symbols1
resOrdered1 <- resLFC1[order(resLFC1$pvalue),]
dds2 <- DESeqDataSetFromMatrix(countData=counts2 , colData=metadata2, design= ~compound,tidy=TRUE)
dds2 <- DESeq(dds2)
resultsNames(dds2)
resLFC2 <- lfcShrink(dds2, contrast = c("compound", "ZNA", "DMSO") , type="ashr")
plotMA(resLFC2)
resLFC2$symbol <- genes.symbols2
resOrdered2 <- resLFC2[order(resLFC2$pvalue),]
genes.symbols2
genes.symbols2
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
genes.symbols2 <- counts2[,2]
#counts2 <- counts2[,-2]
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2[,-2])[-1])), , drop= FALSE]
counts3 <- counts2[c(1,2,4,5,6,8,9,11)] # 12 hrs
counts3[apply(counts3[,-1], 1, function(x) !all(x==0)),] # remove zeros
counts2 <- counts2[c(1,2,3,7,10,12,13,14)] # 3 hrs
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
metadata3 <- data.frame(metadata2[c(2,3,4,6,7,9),])
rownames(metadata3) <- rownames(metadata2)[c(2,3,4,6,7,9)]
names(metadata3)[1] <- "compound"
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
names(a)[1] <- "compound"
metadata2 <- a
#dataset 1 - E2 sampels
counts1 <- read.table("data/E2_treatment.tsv", sep='\t', header=T)
genes.symbols1 <- counts1[,2]
counts1 <- counts1[,-2]
metadata1 <- read.table("data/E2coldata.tsv", sep='\t', header=T)
counts1[apply(counts1[,-1], 1, function(x) !all(x==0)),] # remove zeros
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
##Metadata 1
newdata <- metadata1[8]
rownames(newdata) <- metadata1[,1]
metadata1 <- newdata
names(metadata1)[1] <- "compound"
metadata1[1] <- mapvalues(metadata1[,1],c("17beta-estradiol 10 nanomolar","vehicle") , c("E2","DMSO"))
metadata1$compound <- as.factor(metadata1$compound)
# Ordering the values
metadata1 <- metadata1[order(match(rownames(metadata1),colnames(counts1)[-1])), , drop= FALSE]
##Metadata 2
newdata <- metadata2[10]
rownames(newdata) <- metadata2[,1]
metadata2 <- newdata
names(metadata2)[1] <- "compound"
metadata2[1] <- mapvalues(metadata2[,1],c("ZNA 30 micromolar") , c("ZNA"))
metadata2$compound <- as.factor(metadata2$compound)
# Ordering the values
metadata2 <- metadata2[order(match(rownames(metadata2),colnames(counts2[,-2])[-1])), , drop= FALSE]
rownames(metadata2)
rownames(metadata2) == names(counts2[-2])[-1]
counts3 <- counts2[c(1,2,4,5,6,8,9,11)] # 12 hrs
counts3[apply(counts3[,-1], 1, function(x) !all(x==0)),] # remove zeros
counts2 <- counts2[c(1,2,3,7,10,12,13,14)] # 3 hrs
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
genes.symbols2 <- counts2[,2]
counts2 <- counts2[,-2]
genes.symbols3 <- counts3[,2]
counts3 <- counts3[,-2]
genes.symbols2
metadata3 <- data.frame(metadata2[c(2,3,4,6,7,9),])
rownames(metadata3) <- rownames(metadata2)[c(2,3,4,6,7,9)]
names(metadata3)[1] <- "compound"
a <- data.frame(metadata2[c(1,5,8,10,11,12),])
rownames(a) <- rownames(metadata2)[c(1,5,8,10,11,12)]
names(a)[1] <- "compound"
metadata2 <- a
dds1 <- DESeqDataSetFromMatrix(countData=counts1, colData=metadata1, design= ~compound,tidy=TRUE)
dds1 <- DESeq(dds1)
resultsNames(dds1)
resLFC1 <- lfcShrink(dds1, contrast = c("compound", "E2", "DMSO") , type="ashr")
plotMA(resLFC1)
resLFC1$symbol <- genes.symbols1
resOrdered1 <- resLFC1[order(resLFC1$pvalue),]
dds2 <- DESeqDataSetFromMatrix(countData=counts2 , colData=metadata2, design= ~compound,tidy=TRUE)
dds2 <- DESeq(dds2)
resultsNames(dds2)
resLFC2 <- lfcShrink(dds2, contrast = c("compound", "ZNA", "DMSO") , type="ashr")
plotMA(resLFC2)
resLFC2$symbol <- genes.symbols2
resOrdered2 <- resLFC2[order(resLFC2$pvalue),]
dds3 <- DESeqDataSetFromMatrix(countData=counts3 , colData=metadata3, design= ~compound,tidy=TRUE)
dds3 <- DESeq(dds3)
resultsNames(dds3)
resLFC3 <- lfcShrink(dds3, contrast = c("compound", "ZNA", "DMSO") , type="ashr")
plotMA(resLFC3)
resLFC3$symbol <- genes.symbols3
resOrdered3 <- resLFC3[order(resLFC3$pvalue),]
# Dataset1
EnhancedVolcano(resOrdered1,
lab = resOrdered1$symbol,
x = 'log2FoldChange',
y = 'padj',
labSize=4,
title = 'E2 versus DMSO',
pCutoff = 10e-10,
pointSize = 2.0,
xlim = c(-10, 10),
FCcutoff=2 )
# Dataset2
EnhancedVolcano(resOrdered2,
lab = resOrdered2$symbol,
x = 'log2FoldChange',
y = 'padj',
title = 'ZNA versus DMSO after 3 hours',
labSize=4,
pointSize = 2.0,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
# Dataset1
EnhancedVolcano(resOrdered1,
lab = resOrdered1$symbol,
x = 'log2FoldChange',
y = 'padj',
labSize=4,
title = 'E2 versus DMSO',
pCutoff = 10e-10,
pointSize = 2.0,
xlim = c(-10, 10),
FCcutoff=2 )
# Dataset2
EnhancedVolcano(resOrdered2,
lab = resOrdered2$symbol,
x = 'log2FoldChange',
y = 'padj',
title = 'ZNA versus DMSO after 3 hours',
labSize=4,
pointSize = 2.0,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
EnhancedVolcano(resOrdered3,
lab = resOrdered3$symbol,
x = 'log2FoldChange',
y = 'padj',
title = 'ZNA versus DMSO after 12 hours',
labSize=4,
pointSize = 2.0,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
#Running PCA between E2 and DMSO
dds.symbol <- dds1
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds1),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds1)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
pca_plot <- plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
pca_plot + scale_color_manual(values=c("mediumpurple1","darkolivegreen3"))+
xlab("PC1") +
ylab("PC2") +
ggtitle("PCA analysis for E2 samples") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#Running PCA between ZNA and DMSO after 3hrs
dds.symbol <- dds2
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds2),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds2)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
pca_plot <- plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
pca_plot + scale_color_manual(values=c("mediumpurple1","darkolivegreen3"))+
xlab("PC1") +
ylab("PC2") +
ggtitle("PCA analysis for ZNA samples after 3 hours of treatment") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#Running PCA between ZNA and DMSO after 3hrs
dds.symbol <- dds2
rownames(dds.symbol) <- mapIds(org.Hs.eg.db,
keys=rownames(dds2),
column="SYMBOL",
keytype="ENSEMBL",
multiVals="first")
rownames(dds.symbol)[is.na(rownames(dds.symbol))] <- rownames(dds2)[is.na(rownames(dds.symbol))]
rownames(dds.symbol) <- make.unique(rownames(dds.symbol))
normcounts = assay(vst(dds.symbol,blind=T))
#pheatmap(normcounts[select,], cluster_rows=TRUE,
#   show_colnames = FALSE,cluster_cols=TRUE,
#  annotation_col=df, scale = 'row',cutree_cols = 2,cutree_rows = 2)
pca_plot <- plotPCA(vst(dds.symbol,blind=T),ntop=1000,intgroup="compound")
pca_plot + ggtitle("PCA analysis for ZNA samples after 3 hours of treatment")
# Dataset1
EnhancedVolcano(resOrdered1,
lab = resOrdered1$symbol,
x = 'log2FoldChange',
y = 'padj',
labSize=4,
title = 'E2 versus DMSO',
pCutoff = 10e-10,
pointSize = 2.0,
xlim = c(-10, 10),
FCcutoff=2 )
# Dataset2
EnhancedVolcano(resOrdered2,
lab = resOrdered2$symbol,
x = 'log2FoldChange',
y = 'padj',
title = 'ZNA versus DMSO after 3 hours',
labSize=4,
pointSize = 2.0,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
EnhancedVolcano(resOrdered3,
lab = resOrdered3$symbol,
x = 'log2FoldChange',
y = 'padj',
title = 'ZNA versus DMSO after 12 hours',
labSize=4,
pointSize = 2.0,
pCutoff = 10e-10,
xlim = c(-10, 10),
FCcutoff=2 )
#dataset 2 - ZNA sampels
counts2 <- read.table("data/ZNA_molocule_treatment.tsv", sep='\t', header=T)
metadata2 <- read.table("data/ZNAcoldata.tsv", sep='\t', header=T)
counts2[apply(counts2[,-1], 1, function(x) !all(x==0)),] # remove zeros
View(metadata2)
